{"version":3,"sources":["App/toGeoJson.ts","App/setCluster.ts","App/distance-label.ts","App/Header.tsx","api/index.ts","App/Shop.tsx","App/MapSearch.tsx","App/Map.tsx","App/Home.tsx","App/ShopListItem.tsx","App/List.tsx","geolocation.ts","App/Tabbar.tsx","App/CircularIndeterminate.tsx","App/Form.tsx","App/Post.tsx","App.tsx","Qrcode.tsx","About.tsx","Container.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["toGeoJson","data","geojson","type","features","id","item","feature","geometry","coordinates","Number","properties","_id","i","Object","keys","length","key","push","setCluster","map","addLayer","source","filter","paint","layout","on","e","queryRenderedFeatures","point","layers","clusterId","cluster_id","getSource","getClusterExpansionZoom","err","zoom","easeTo","center","getCanvas","style","cursor","makeDistanceLabelText","distance","distanceTipText","isNaN","Math","round","Content","className","URL","getHeaders","a","getAccessToken","accessToken","Authorization","payload","client_id","client_secret","refresh_token","grant_type","axios","post","response","status","Error","access_token","postPreview","parameters","navigate","function","headers","create","instance","includes","console","error","getSafetyData","result","postLike","postUnlike","props","mapNode","useRef","useState","setMap","total","setTotal","isLiked","setIsLiked","isLoading","setIsLoading","shop","clickHandler","close","current","remove","useEffect","nextMap","window","geolonia","Map","container","interactive","localStorage","getItem","text","category","content","onPostLike","index","res","setItem","onPostUnlike","removeItem","onClick","margin","to","display","CircularProgress","src","alt","width","wordBreak","split","line","undefined","ref","height","marginTop","CustomizedInputBase","changeLocationName","event","setPlace","target","value","geocode","Paper","component","sx","p","alignItems","IconButton","InputBase","ml","flex","placeholder","inputProps","onChange","onKeyPress","googleMapsApiKey","CSS","position","hidePoiLayers","hideLayers","layerId","setLayoutProperty","parseHash","url","qstr","location","hash","substring","URLSearchParams","React","mapObject","setMapObject","setShop","useZLatLngString","zLatLngString","setZLatLngString","addSource","cluster","clusterMaxZoom","clusterRadius","addMarkers","q","set","toString","replace","zlatlng","get","inputLat","setLat","inputLng","setLng","place","bounds","geojsonExtent","fitBoundsOptions","padding","lat","lng","flyTo","fitBounds","onMapLoad","getCenter","rawZoom","getZoom","precision","ceil","LN2","log","LN10","m","pow","zStr","orienteationchangeHandler","resize","addEventListener","removeEventListener","off","google","maps","Geocoder","address","results","CustomizedSnackbars","lazy","ms","Promise","resolve","setTimeout","then","useLocation","showPin","Tooltip","title","placement","arrow","open","fallback","search","popupHandler","size","color","sortShopList","shopList","reject","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","enableHighAccuracy","timeout","maximumAge","currentPosition","from","turf","sortingShopList","parseFloat","units","sort","b","useNavigate","setData","list","setList","page","setPage","hasMore","setHasMore","categoryList","setCategoryList","useSearchParams","queryCategory","categories","indexOf","isMounted","sortedData","slice","loader","textAlign","top","htmlFor","options","label","dataLength","next","scrollableTarget","CircularIndeterminate","Box","justifyContent","lon","timestamp","dayjs","format","spot","introduction","inputs","setInputs","handleChange","name","values","handleSubmit","setAddress","params","pname","prefecture","mname","municipality","section","local","Typography","variant","gutterBottom","mb","FormControl","fullWidth","LocalizationProvider","dateAdapter","AdapterDayjs","Stack","spacing","DateTimePicker","renderInput","TextField","InputLabel","Select","MenuItem","multiline","rows","Button","disabled","item1","item2","Date","parse","App","setShopList","fetch","process","getTime","ok","fetchedData","JSON","nextShopList","pattern","test","sortedShopList","path","element","Qrcode","Canvas","useQRCode","logoUrl","config","logo_image_url","href","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","catch","ReactDOM","render","StrictMode","document","getElementById","origin","contentType","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.d25a0faf.chunk.js","sourcesContent":["type Geometry = {\n  type: string;\n  coordinates: number[]\n}\n\ntype featureProperties = {\n  [key: string]: string;\n}\n\ntype Feature = {\n  type: string;\n  geometry: Geometry;\n  properties: featureProperties\n}\n\ntype itemObject = {\n  [key: string]: any;\n}\n\ntype GeoJSON = {\n  type: string;\n  features: Feature[]\n}\n\nconst toGeoJson = (data: any) => {\n  const geojson = {\n    type: \"FeatureCollection\",\n    features: []\n  } as GeoJSON\n\n  for (const id in data) {\n    const item = data[id] as itemObject\n\n    if (!item['経度'] || !item['緯度'] || !item['スポット名']) {\n      return;\n    }\n\n    const feature = {\n      type: \"Feature\",\n      geometry: {\n        type: \"Point\",\n        coordinates: [Number(item['経度']), Number(item['緯度'])]\n      },\n      properties: {_id: id}\n    } as Feature\n\n    for (let i = 0; i < Object.keys(item).length; i++) {\n      const key = Object.keys(item)[i]\n      feature.properties[key] = item[key]\n    }\n\n    geojson.features.push(feature)\n  }\n\n  return geojson\n}\n\nexport default toGeoJson;\n","const setCluster = (map: any) => {\n  map.addLayer({\n    id: 'clusters',\n    type: 'circle',\n    source: 'shops',\n    filter: ['has', 'point_count'],\n    paint: {\n      'circle-radius': 20,\n      'circle-color': '#FF0000',\n      'circle-opacity': 1.0,\n    },\n  })\n\n  map.addLayer({\n    id: 'cluster-count',\n    type: 'symbol',\n    source: 'shops',\n    filter: ['has', 'point_count'],\n    paint: {\n      'text-color': '#FFFFFF',\n    },\n    layout: {\n      'text-field': '{point_count_abbreviated} 件',\n      'text-size': 12,\n      'text-font': ['Noto Sans Regular'],\n    },\n  })\n\n  map.on('click', 'clusters', (e: any) => {\n    const features = map.queryRenderedFeatures(e.point, { layers: ['clusters'] })\n    const clusterId = features[0].properties.cluster_id\n    map.getSource('shops').getClusterExpansionZoom(clusterId, (err: any, zoom: number) => {\n      if (err)\n        return\n\n      map.easeTo({\n        center: features[0].geometry.coordinates,\n        zoom: zoom,\n      })\n    })\n  })\n\n  map.on('mouseenter', 'clusters', function () {\n    map.getCanvas().style.cursor = 'pointer'\n  })\n\n  map.on('mouseleave', 'clusters', function () {\n    map.getCanvas().style.cursor = ''\n  })\n}\n\nexport default setCluster;\n","export const makeDistanceLabelText = (distance: number | void) => {\n  let distanceTipText = \"\"\n  if(typeof distance === 'number' && !Number.isNaN(distance)) {\n    if(distance > 1000) {\n      distanceTipText = Math.round(distance / 1000) + ' km'\n    } else {\n      distanceTipText = Math.round(distance) + ' m'\n    }\n  }\n  return distanceTipText\n}\n","import './Header.scss'\n\nconst Content = () => {\n  return (\n    <div className=\"head\">\n      <p>通学路安全マップ</p>\n    </div>\n  )\n}\n\nexport default Content\n","import axios from \"axios\"\nimport { NavigateFunction } from \"react-router-dom\"\n\nconst CLIENT_ID = '430416577043-vaudgfur0pdk5qqc1bmrfchuuf5cgkcv.apps.googleusercontent.com'\nconst CLIENT_SECRET = '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'\nconst REFRESH_TOKEN = '1//0ejQEdwBJDx_uCgYIARAAGA4SNwF-L9Irw8w44X-7S4kYaW84_Ra2ae7t8f0KdwmOsVUB9QjOCpJZWxaPaIp7bsfkio69JR0ebFA'\nconst SCRIPT_ID = 'AKfycbwnv-EH1C95J6wSjfRpV28c3D-WE80NR2KVD-edX7zJauR0AYVZN95wXZfNxOsopZWq'\nconst TOKEN_URL = 'https://oauth2.googleapis.com/token'\n\nconst URL = `https://script.googleapis.com/v1/scripts/${SCRIPT_ID}:run`\n\nconst getHeaders = async () => {\n  const accessToken = await getAccessToken()\n  return {\n    Authorization: `Bearer ${accessToken}`,\n  }\n}\n\n/**\n * アクセストークンを取得する関数\n * @return string\n */\nconst getAccessToken = async () => {\n  const payload = {\n    client_id: CLIENT_ID,\n    client_secret: CLIENT_SECRET,\n    refresh_token: REFRESH_TOKEN,\n    grant_type: 'refresh_token',\n  }\n  // リクエスト\n  const response = await axios.post(TOKEN_URL, payload)\n  if (response.status !== 200 || !response.data) {\n    throw new Error('Failed to get access token.')\n  }\n  const accessToken = response.data.access_token\n  return accessToken\n}\n\n/**\n * @return string\n */\nexport const postPreview = async (parameters: any, navigate: NavigateFunction) => {\n  try {\n    const payload = {\n      function: 'postUserPost',\n      parameters,\n    }\n    const headers = await getHeaders()\n    const instance = await axios.create({ headers })\n    const response = await instance.post(URL, payload) as any\n    if (response.data.response['@type'].includes('error')) {\n      throw new Error()\n    } else {\n      navigate('/?success')\n    }\n  } catch (e) {\n    console.error(e)\n    throw e\n  }\n}\n\nexport const getSafetyData = async () => {\n  try {\n    const payload = {\n      function: 'getSafetyData',\n    }\n    const headers = await getHeaders()\n    const instance = await axios.create({ headers })\n    const response = await instance.post(URL, payload) as any\n    if (response.data.response['@type'].includes('error')) {\n      throw new Error()\n    } else {\n      return response.data.response.result\n    }\n  } catch (e) {\n    console.error(e)\n    throw e\n  }\n}\n\nexport const postLike = async (parameters: any) => {\n  try {\n    const payload = {\n      function: 'postLike',\n      parameters,\n    }\n    const headers = await getHeaders()\n    const instance = await axios.create({ headers })\n    const response = await instance.post(URL, payload) as any\n    if (response.data.response['@type'].includes('error')) {\n      throw new Error()\n    } else {\n      return response.data.response.result\n    }\n  } catch (e) {\n    console.error(e)\n    throw e\n  }\n}\n\nexport const postUnlike = async (parameters: any) => {\n  try {\n    const payload = {\n      function: 'postUnlike',\n      parameters,\n    }\n    const headers = await getHeaders()\n    const instance = await axios.create({ headers })\n    const response = await instance.post(URL, payload) as any\n    if (response.data.response['@type'].includes('error')) {\n      throw new Error()\n    } else {\n      return response.data.response.result\n    }\n  } catch (e) {\n    console.error(e)\n    throw e\n  }\n}\n","import { useState, useEffect, useRef } from \"react\"\nimport './Shop.scss'\nimport { Link } from \"react-router-dom\";\nimport { makeDistanceLabelText } from \"./distance-label\";\nimport Header from \"./Header\";\nimport { postLike, postUnlike } from \"../api\"\nimport { CircularProgress } from \"@mui/material\"\n\ntype Props = {\n  shop: Pwamap.ShopData;\n  close: Function;\n}\n\nconst Content = (props: Props) => {\n  const mapNode = useRef<HTMLDivElement>(null)\n  const [map, setMap] = useState<any>(null)\n  const [total, setTotal] = useState<number>(0)\n  const [isLiked, setIsLiked] = useState(false)\n  const [isLoading, setIsLoading] = useState(false)\n\n  const { shop } = props\n\n  const clickHandler = () => {\n    props.close()\n    if(mapNode.current) {\n      mapNode.current.remove()\n      map.remove()\n    }\n  }\n\n  useEffect(() => {\n    if (!mapNode.current) {\n      return\n    }\n\n    // @ts-ignore\n    const nextMap = new window.geolonia.Map({\n      container: mapNode.current,\n      interactive: false,\n      zoom: 14,\n      style: `geolonia/gsi`,\n    });\n    setMap(nextMap)\n\n    setIsLiked(!!localStorage.getItem(`like:${shop['index']}`))\n  }, [shop, mapNode])\n\n  const distanceTipText = makeDistanceLabelText(shop.distance)\n  const category = shop['カテゴリ']\n  const content = shop['紹介文']\n\n  const toBreakLine = (text: string) => {\n\n    return text.split(/(\\r\\n)|(\\n)|(\\r)/g).map((line, i) => {\n\n      let result: any = '';\n\n      if (line === '\\r\\n' || line === '\\n' || line === '\\r') {\n        result = <br key={i} />\n      } else if (line !== undefined) {\n        result = line\n      }\n\n      return result\n    })\n  }\n\n  const onPostLike = async () => {\n    setIsLoading(true)\n    const res = await postLike({ index: shop['index'] })\n    setTotal(res)\n    localStorage.setItem(`like:${shop['index']}`, 'true')\n    setIsLiked(true)\n    setIsLoading(false)\n  }\n\n  const onPostUnlike = async () => {\n    setIsLoading(true)\n    const res = await postUnlike({ index: shop['index'] })\n    setTotal(res)\n    localStorage.removeItem(`like:${shop['index']}`)\n    setIsLiked(false)\n    setIsLoading(false)\n  }\n\n  return (\n    <div className=\"shop-single\">\n      <Header />\n      <div className=\"shop-container\">\n        <div className=\"back\"><button onClick={clickHandler}>{'< 戻る'}</button></div>\n        {shop?\n          <>\n            <h2>{shop['スポット名']}</h2>\n\n            <div style={{ margin: \"0 0 12px 0\" }}>\n              <span className=\"nowrap\">\n                <Link to={`/list?category=${category}`}>\n                  <span onClick={clickHandler} className=\"category\">{category}</span>\n                </Link>\n              </span>\n              <span className=\"nowrap\">{distanceTipText && <span className=\"distance\">現在位置から {distanceTipText}</span> }</span>\n            </div>\n\n            {shop['いいね数'] === 0 || shop['いいね数'] > 0 ? <div style={{ display: 'flex' }}>\n              {isLoading ? <CircularProgress /> : <img src={isLiked ? 'thumb-up.png' : 'thumb-up-outline.png'} alt=\"いいね\" width='28px' className=\"like-button\" onClick={isLiked ? onPostUnlike : onPostLike} />}\n              <p style={{ margin: '2px' }}>{total || shop['いいね数']}</p>\n            </div> : <></>}\n\n            <p style={{margin: \"24px 0\", wordBreak: \"break-all\"}}>{toBreakLine(content)}</p>\n\n            <div\n              ref={mapNode}\n              style={{width: '100%', height: '200px', marginTop: \"24px\"}}\n              data-lat={shop['緯度']}\n              data-lng={shop['経度']}\n              data-navigation-control=\"off\"\n            ></div>\n          </>\n          :\n          <></>\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Content;\n","import * as React from 'react'\nimport Paper from '@mui/material/Paper'\nimport InputBase from '@mui/material/InputBase'\nimport IconButton from '@mui/material/IconButton'\nimport { FaSearch } from 'react-icons/fa'\nimport { LoadScript } from '@react-google-maps/api'\n\nconst GOOGLE_MAP_API_KEY = process.env.REACT_APP_GOOGLE_MAP_API_KEY || ''\n\ntype Props = {\n  geocode: () => void\n  setPlace: React.Dispatch<React.SetStateAction<undefined>>\n}\n\nexport default function CustomizedInputBase(props: Props) {\n  const changeLocationName = (event: any) => {\n    if (event.key === 'Enter') {\n      props.geocode()\n      return\n    }\n    props.setPlace(event.target.value)\n  }\n  return (\n    <Paper\n      component=\"form\"\n      sx={{ p: '2px 4px', display: 'flex', alignItems: 'center' }}\n    >\n      <IconButton type=\"button\" sx={{ p: '10px' }} aria-label=\"search\">\n        <FaSearch />\n      </IconButton>\n      <InputBase\n        sx={{ ml: 1, flex: 1 }}\n        placeholder=\"住所で検索\"\n        inputProps={{ 'aria-label': '住所で検索' }}\n        onChange={(event) => changeLocationName(event)}\n        onKeyPress={(event) => changeLocationName(event)}\n        style={{ height: '60px' }}\n      />\n      <LoadScript googleMapsApiKey={GOOGLE_MAP_API_KEY}>\n      </LoadScript>\n\n    </Paper>\n  )\n}\n","import React from \"react\";\n// @ts-ignore\nimport geojsonExtent from '@mapbox/geojson-extent'\nimport toGeoJson from './toGeoJson'\nimport setCluster from './setCluster'\nimport Shop from './Shop'\nimport Header from './Header'\nimport MapSearch from \"./MapSearch\"\nimport { useState } from 'react'\n\ntype Props = {\n  data: Pwamap.ShopData[];\n  useZLatLngString: [string, React.Dispatch<React.SetStateAction<string>>]\n};\n\nconst CSS: React.CSSProperties = {\n  width: '100%',\n  height: '100%',\n  position: 'relative',\n}\n\nconst hidePoiLayers = (map: any) => {\n\n  const hideLayers = [\n    'poi',\n    'poi-primary',\n    'poi-r0-r9',\n    'poi-r10-r24',\n    'poi-r25',\n    'poi-bus',\n    'poi-entrance',\n  ]\n\n  for (let i = 0; i < hideLayers.length; i++) {\n    const layerId = hideLayers[i];\n    map.setLayoutProperty(layerId, 'visibility', 'none')\n  }\n}\n\nconst parseHash = (url?: Location | URL) => {\n  const qstr = (url || window.location).hash.substring(2);\n  const q = new URLSearchParams(qstr);\n  return q;\n};\n\nconst updateHash = (q: URLSearchParams) => {\n\n  const hash = q.toString();\n  if (hash) {\n    window.location.hash = `#/?${q.toString().replace(/%2F/g, '/')}`;\n  }\n};\n\nconst Content = (props: Props) => {\n  const mapNode = React.useRef<HTMLDivElement>(null);\n  const [mapObject, setMapObject] = React.useState<any>()\n  const [shop, setShop] = React.useState<Pwamap.ShopData | undefined>(undefined)\n  const [zLatLngString, setZLatLngString] = props.useZLatLngString\n  const addMarkers = (mapObject: any, data: any) => {\n\n    if (!mapObject || !data) {\n      return\n    }\n\n    mapObject.on('render', () => {\n\n      // nothing to do if shops exists.\n      if (mapObject.getSource('shops')) {\n        return\n      }\n\n      hidePoiLayers(mapObject)\n\n      const textColor = '#000000'\n      const textHaloColor = '#FFFFFF'\n\n      const geojson = toGeoJson(data)\n\n      mapObject.addSource('shops', {\n        type: 'geojson',\n        data: geojson,\n        cluster: true,\n        clusterMaxZoom: 14,\n        clusterRadius: 25,\n      })\n\n      mapObject.addLayer({\n        id: 'shop-points',\n        type: 'circle',\n        source: 'shops',\n        filter: ['all',\n          ['==', '$type', 'Point'],\n        ],\n        paint: {\n          'circle-radius': 13,\n          'circle-color': '#FF0000',\n          'circle-opacity': 0.4,\n          'circle-stroke-width': 2,\n          'circle-stroke-color': '#FFFFFF',\n          'circle-stroke-opacity': 1,\n        },\n      })\n\n      mapObject.addLayer({\n        id: 'shop-symbol',\n        type: 'symbol',\n        source: 'shops',\n        filter: ['all',\n          ['==', '$type', 'Point'],\n        ],\n        paint: {\n          'text-color': textColor,\n          'text-halo-color': textHaloColor,\n          'text-halo-width': 2,\n        },\n        layout: {\n          'text-field': \"{スポット名}\",\n          'text-font': ['Noto Sans Regular'],\n          'text-variable-anchor': ['top', 'bottom', 'left', 'right'],\n          'text-radial-offset': 0.5,\n          'text-justify': 'auto',\n          'text-size': 12,\n          'text-anchor': 'top',\n          'text-max-width': 12,\n          'text-allow-overlap': false,\n        },\n      })\n\n      mapObject.on('mouseenter', 'shop-points', () => {\n        mapObject.getCanvas().style.cursor = 'pointer'\n      })\n\n      mapObject.on('mouseleave', 'shop-points', () => {\n        mapObject.getCanvas().style.cursor = ''\n      })\n\n      mapObject.on('mouseenter', 'shop-symbol', () => {\n        mapObject.getCanvas().style.cursor = 'pointer'\n      })\n\n      mapObject.on('mouseleave', 'shop-symbol', () => {\n        mapObject.getCanvas().style.cursor = ''\n      })\n\n      mapObject.on('click', 'shop-points', (event: any) => {\n        if (!event.features[0].properties.cluster) {\n          setShop(event.features[0].properties)\n        }\n      })\n\n      mapObject.on('click', 'shop-symbol', (event: any) => {\n        if (!event.features[0].properties.cluster) {\n          setShop(event.features[0].properties)\n        }\n      })\n\n      setCluster(mapObject)\n    });\n\n  }\n\n  React.useEffect(() => {\n\n    addMarkers(mapObject, props.data)\n\n  }, [mapObject, props.data])\n\n  React.useEffect(() => {\n    const hash = parseHash();\n    if (zLatLngString) {\n      hash.set('map', zLatLngString);\n    }\n    updateHash(hash);\n\n  }, [ zLatLngString ]);\n\n  const hash = parseHash()\n  const latLngString = hash.get('map') || ''\n  const zlatlng = latLngString.split('/')\n  const [inputLat, setLat] = useState(zlatlng[1])\n  const [inputLng, setLng] = useState(zlatlng[2])\n  const [place, setPlace] = useState()\n\n  // @ts-ignore\n  const { geolonia } = window\n\n  const geojson = toGeoJson(props.data)\n  const bounds = geojsonExtent(geojson)\n\n  const geocode = () => {\n    const geocoder = new window.google.maps.Geocoder()\n    geocoder.geocode({ address: place }, (results, status) => {\n      if (status === 'OK' && results) {\n        const lat = results[0].geometry.location.lat().toString()\n        const lng = results[0].geometry.location.lng().toString()\n\n        setLat(lat)\n        setLng(lng)\n\n        const map = new geolonia.Map({\n          container: mapNode.current,\n          style: 'geolonia/gsi',\n          bounds: bounds,\n          fitBoundsOptions: { padding: 50 },\n        });\n\n        map.flyTo({ center: [lng, lat], zoom: 16 })\n      }\n    })\n  }\n\n  React.useEffect(() => {\n    // Only once reder the map.\n    if (!mapNode.current || mapObject) {\n      return\n    }\n\n    const map = new geolonia.Map({\n      container: mapNode.current,\n      style: 'geolonia/gsi',\n      bounds: bounds,\n      fitBoundsOptions: { padding: 50 },\n    })\n\n    const hash = parseHash()\n    if (hash && hash.get('map')) {\n      const latLngString = hash.get('map') || ''\n      const zlatlng = latLngString.split('/')\n      const zoom = zlatlng[0]\n      const lat = zlatlng[1]\n      const lng = zlatlng[2]\n\n      map.flyTo({ center: [lng, lat], zoom });\n\n    } else if (bounds) {\n\n      map.fitBounds(bounds, { padding: 50 })\n\n    }\n\n    const onMapLoad = () => {\n      hidePoiLayers(map)\n      setMapObject(map)\n\n      map.on('moveend', () => {\n        // see: https://github.com/maplibre/maplibre-gl-js/blob/ba7bfbc846910c5ae848aaeebe4bde6833fc9cdc/src/ui/hash.js#L59\n        const center = map.getCenter(),\n          rawZoom = map.getZoom(),\n          zoom = Math.round(rawZoom * 100) / 100,\n          // derived from equation: 512px * 2^z / 360 / 10^d < 0.5px\n          precision = Math.ceil((zoom * Math.LN2 + Math.log(512 / 360 / 0.5)) / Math.LN10),\n          m = Math.pow(10, precision),\n          lng = Math.round(center.lng * m) / m,\n          lat = Math.round(center.lat * m) / m,\n          zStr = Math.ceil(zoom);\n\n        setZLatLngString(`${zStr}/${lat}/${lng}`);\n      });\n    }\n\n    const orienteationchangeHandler = () => {\n      map.resize()\n    }\n\n    // attach\n    map.on('load', onMapLoad)\n\n    window.addEventListener('orientationchange', orienteationchangeHandler)\n\n    return () => {\n      // detach to prevent memory leak\n      window.removeEventListener('orientationchange', orienteationchangeHandler)\n      map.off('load', onMapLoad)\n    }\n  })\n\n  const closeHandler = () => {\n    setShop(undefined)\n  }\n\n  return (\n    <div style={CSS}>\n      <Header />\n\n      <MapSearch geocode={geocode} setPlace={setPlace} />\n\n      <div\n        ref={mapNode}\n        style={CSS}\n        data-lat={inputLat}\n        data-lng={inputLng}\n        data-geolocate-control=\"on\"\n        data-marker=\"off\"\n      ></div>\n      {shop ?\n        <Shop shop={shop} close={closeHandler} />\n        :\n        <></>\n      }\n    </div>\n  );\n};\n\nexport default Content;\n","import Map from \"./Map\"\nimport './Home.scss'\nimport { Link, useLocation } from \"react-router-dom\"\nimport React, { lazy, Suspense } from \"react\"\nimport { Tooltip } from \"@material-ui/core\"\n\nconst sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms))\n\nconst CustomizedSnackbars = lazy(() => sleep(1000).then(() => import('./Snackbars')));\n\ntype Props = {\n  data: Pwamap.ShopData[];\n}\n\nconst Content = (props: Props) => {\n  const location = useLocation();\n  const useZLatLngString = React.useState<string>('')\n  const [showPin] = React.useState<boolean>(false)\n  return (\n    <div className=\"home-container\">\n      <Link to={`/post?${useZLatLngString['0']}`}>\n        {showPin ? <Tooltip\n          className=\"center\"\n          title=\"この位置に要望を投稿\"\n          placement=\"top\"\n          arrow\n          open={true}\n        >\n          <div><img src='map-pin.png' alt=\"map pin\" className=\"map-pin\" /></div>\n        </Tooltip> : ''}\n      </Link>\n      <Map data={props.data} useZLatLngString={useZLatLngString} />\n      {/* マップ上にピンを立てるボタンを非表示 */}\n      {/* <button className=\"map-pin-button\" onClick={() => setShowPin(!showPin)}>\n        <img className=\"map-pin-button__plus-math\" src={`${showPin ? 'multiply' : 'plus-math'}.png`} alt=\"plus math\" />\n      </button> */}\n      <Suspense fallback=''>\n        {location.search.includes('success') ? <CustomizedSnackbars /> : ''}\n      </Suspense>\n    </div>\n  );\n};\n\nexport default Content;\n","import { BsChevronCompactRight } from 'react-icons/bs'\nimport './ShopListItem.scss'\nimport { Link } from \"react-router-dom\";\nimport { makeDistanceLabelText } from \"./distance-label\";\n\ntype Props = {\n  data: Pwamap.ShopData;\n  popupHandler: Function\n};\n\nconst Content = (props: Props) => {\n  const clickHandler = () => {\n    props.popupHandler(props.data)\n  }\n\n  const distanceTipText = makeDistanceLabelText(props.data.distance)\n  const category = props.data['カテゴリ']\n\n\n  return (\n    <>\n      <div className=\"shop-link\">\n        <h2 className=\"shop-title\" style={{ wordBreak: \"break-all\" }} onClick={clickHandler}>{props.data['スポット名']}</h2>\n        <div className='tag-box'>\n\n            <span className=\"nowrap\">\n              <Link to={`/list?category=${category}`}>\n                <span className=\"category\">{category}</span>\n              </Link>\n            </span>\n\n          <span className=\"nowrap\">{distanceTipText && <span className=\"distance\">現在位置から {distanceTipText}</span>}</span>\n        </div>\n\n        <div style={{ margin: \"10px 10px 10px 0\" }}>\n\n        </div>\n\n        <div className=\"right\" onClick={clickHandler}><BsChevronCompactRight size=\"40px\" color=\"#CCCCCC\" /></div>\n      </div>\n    </>\n  );\n};\n\nexport default Content;\n","import React from \"react\";\nimport ShopListItem from './ShopListItem'\nimport Shop from './Shop'\nimport './List.scss'\nimport { useSearchParams } from \"react-router-dom\";\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport { askGeolocationPermission } from '../geolocation'\nimport * as turf from \"@turf/turf\"\nimport Select from 'react-select'\nimport { useNavigate } from 'react-router-dom';\nimport Header from './Header'\n\ntype Props = {\n  data: Pwamap.ShopData[];\n}\n\nconst sortShopList = async (shopList: Pwamap.ShopData[]) => {\n  const currentPosition = await askGeolocationPermission()\n  if(currentPosition) {\n    const from = turf.point(currentPosition);\n    const sortingShopList = shopList.map((shop) => {\n      const lng = parseFloat(shop['経度'])\n      const lat = parseFloat(shop['緯度'])\n      if(Number.isNaN(lng) || Number.isNaN(lat)) {\n        return shop\n      } else {\n        const to = turf.point([lng, lat])\n        const distance = turf.distance(from, to, {units: 'meters' as 'meters'});\n        return { ...shop, distance }\n      }\n    })\n    sortingShopList.sort((a,b) => {\n      if(typeof a.distance !== 'number' || Number.isNaN(a.distance)) {\n        return 1\n      } else if (typeof b.distance !== 'number' || Number.isNaN(b.distance)) {\n        return -1\n      } else {\n        return a.distance - b.distance\n      }\n    })\n    return sortingShopList\n  } else {\n    return shopList\n  }\n}\n\nconst Content = (props: Props) => {\n  const navigate = useNavigate();\n\n  const [shop, setShop] = React.useState<Pwamap.ShopData | undefined>()\n  const [data, setData] = React.useState<Pwamap.ShopData[]>(props.data)\n  const [list, setList] = React.useState<any[]>([]);\n  const [page, setPage] = React.useState(10);\n  const [hasMore, setHasMore] = React.useState(true);\n  const [categoryList, setCategoryList] = React.useState<string[]>([]);\n\n\n  const [searchParams] = useSearchParams();\n  const queryCategory = searchParams.get('category')\n\n  React.useEffect(() => {\n\n    let categories: string[] = []\n\n    for (let i = 0;i < props.data.length;i++) {\n      const shop = props.data[i]\n\n      if (categories.indexOf(shop['カテゴリ']) === -1) {\n\n        categories.push(shop['カテゴリ'])\n      }\n\n    }\n\n    setCategoryList(categories)\n\n\n    let data = props.data;\n\n    if (queryCategory) {\n      data = props.data.filter((shop) => {\n        return shop['カテゴリ'] === queryCategory\n      })\n    }\n\n    let isMounted = true\n    // prevent memory leak\n    if (isMounted) {\n\n      const orderBy = process.env.REACT_APP_ORDERBY\n\n      if (orderBy === 'distance') {\n\n        sortShopList(data)\n          .then(sortedData => {\n            // prevent memory leak\n            if (isMounted) {\n              setList(sortedData.slice(0, page))\n              setData(sortedData)\n            }\n          })\n\n      } else {\n        setList(data.slice(0, page))\n        setData(data)\n      }\n    }\n\n    return () => {\n      isMounted = false\n    }\n  }, [props.data, queryCategory, page])\n\n\n  const popupHandler = (shop: Pwamap.ShopData) => {\n    if (shop) {\n      setShop(shop)\n    }\n  }\n\n  const closeHandler = () => {\n    setShop(undefined)\n  }\n\n    //項目を読み込むときのコールバック\n    const loadMore = () => {\n\n      //データ件数が0件の場合、処理終了\n      if (list.length >= data.length) {\n        setHasMore(false);\n        return;\n      }\n\n      setList([...list, ...data.slice(page, page + 10)])\n      setPage(page + 10)\n    }\n\n  const loader = <div\n    className=\"loader\"\n    key={0}\n    style={{\n      width: '100%',\n      height: '200px',\n      textAlign: 'center',\n      position: 'relative',\n      top: '100px'\n    }}\n  >場所一覧を読み込み中です...</div>;\n\n  return (\n    <div id=\"shop-list\" className=\"shop-list\">\n      <Header />\n      <div className=\"category-item\">\n        <div className=\"category-container\">\n          <label htmlFor=\"category-select\">カテゴリから選ぶ</label>\n          <Select\n            onChange={(e) => {\n              if (e) {\n                navigate(`/list?category=${e.value}`)\n              }\n            }}\n            options={\n              categoryList.map(category => {\n                return {\n                  value: category,\n                  label: category\n                }\n              })\n            }\n          />\n        </div>\n      </div>\n      <InfiniteScroll\n        dataLength={list.length}\n        next={loadMore}\n        hasMore={hasMore}\n        loader={loader}\n        scrollableTarget=\"shop-list\"\n      >\n        {\n          list.map((item, index) => {\n            return (<div key={index} className=\"shop\">\n              <ShopListItem\n                data={item}\n                popupHandler={popupHandler}\n              />\n            </div>)\n\n          })\n        }\n      </InfiniteScroll>\n      {shop ?\n        <Shop shop={shop} close={closeHandler} />\n        :\n        <></>\n      }\n    </div>\n  );\n};\n\nexport default Content;\n","export const askGeolocationPermission = () => {\n  return new Promise<Pwamap.LngLat | null>((resolve, reject) => {\n\n    if(!window.navigator.geolocation || !window.navigator.geolocation.getCurrentPosition) {\n      resolve(null)\n    }\n\n    window.navigator.geolocation.getCurrentPosition(\n      (pos) => {\n        const lat = pos.coords.latitude\n        const lng = pos.coords.longitude\n        resolve([lng, lat])\n      },\n      (error) => {\n        resolve(null)\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 0\n      }\n    )\n  })\n}\n","import { Link } from \"react-router-dom\";\nimport './Tabbar.scss'\n\nimport { FaList, FaHome } from \"react-icons/fa\"\n\nconst Content = () => {\n  return (\n    <div className=\"tabbar\">\n      <ul>\n        <li><Link to=\"/\"><div className=\"icon\"><FaHome /></div><div className=\"text\">ホーム</div></Link></li>\n        <li><Link to=\"/list\"><div className=\"icon\"><FaList /></div><div className=\"text\">一覧</div></Link></li>\n      </ul>\n    </div>\n  );\n};\n\nexport default Content;\n","import * as React from 'react'\nimport CircularProgress from '@mui/material/CircularProgress'\nimport Box from '@mui/material/Box'\n\nexport default function CircularIndeterminate() {\n  return (\n    <Box sx={{ display: 'flex', justifyContent: 'center' }}>\n      <CircularProgress />\n    </Box>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport axios from \"axios\"\nimport Header from './Header'\nimport { postPreview } from '../api'\nimport { Button, FormControl, InputLabel, MenuItem, Select, Typography } from '@material-ui/core'\nimport { LocalizationProvider } from '@mui/x-date-pickers'\nimport { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'\nimport TextField from '@mui/material/TextField'\nimport Stack from '@mui/material/Stack'\nimport { DateTimePicker } from '@mui/x-date-pickers/DateTimePicker'\nimport dayjs from 'dayjs'\nimport CircularIndeterminate from './CircularIndeterminate'\nimport { useNavigate } from \"react-router-dom\";\nimport './Form.scss'\n\ntype Input = {\n  title: string\n  category: string\n  latitude: string\n  longitude: string\n  timestamp: string\n  spot: string\n  introduction: string\n}\n\nconst zlatlng = window.location.hash.split('/')\nconst lat = zlatlng[2]\nconst lon = zlatlng[3]\n\nconst Content = () => {\n  const [inputs, setInputs] = useState<Input>({\n    title: '',\n    category: '住民要望',\n    latitude: lat,\n    longitude: lon,\n    timestamp: dayjs().format('YYYY-MM-DDTHH:mm:ss'),\n    spot: '',\n    introduction: '',\n  })\n\n  const handleChange = (e: any) => {\n    const name = e.target?.name\n    const value = name ? e.target?.value : dayjs(e).format('YYYY-MM-DDTHH:mm:ss')\n    setInputs(values => ({ ...values, [name || 'timestamp']: value }))\n  }\n\n  const [isLoading, setIsLoading] = useState(false)\n  const navigate = useNavigate();\n\n  const handleSubmit = async () => {\n    setIsLoading(true)\n    await postPreview(inputs, navigate)\n    setIsLoading(false)\n  }\n\n  const [address, setAddress] = useState(\"\")\n\n  useEffect(() => {\n    (async () => {\n      const zlatlng = window.location.hash.split('/')\n      const lat = zlatlng[2]\n      const lon = zlatlng[3]\n      if (lat && lon) {\n        const res = await axios.get(\n          \"https://aginfo.cgk.affrc.go.jp/ws/rgeocode.php?json\",\n          {\n            params: {\n              lat,\n              lon\n            }\n          }\n        )\n        const { result } = res.data\n        const { prefecture: { pname }, municipality: { mname } } = result\n        const { section } = result.local[0]\n\n        setAddress(pname + mname + section)\n      }\n    })()\n  })\n\n\n  return (\n    <>\n      <Header />\n\n      <div className='form-container'>\n        <Typography variant=\"h5\" gutterBottom margin=\"normal\">\n          要望を投稿\n        </Typography>\n\n        <Typography variant=\"h6\" gutterBottom sx={{ mb: 2 }}>\n          {address ? address + ' 付近' : ''}\n        </Typography>\n\n        <FormControl fullWidth>\n          <LocalizationProvider dateAdapter={AdapterDayjs}>\n            <Stack spacing={3} sx={{ mb: 2 }}>\n              <DateTimePicker\n                renderInput={(params) => <TextField {...params} />}\n                label=\"日時\"\n                value={inputs.timestamp}\n                onChange={handleChange}\n              />\n            </Stack>\n          </LocalizationProvider>\n\n          <FormControl fullWidth>\n            <InputLabel>スポット</InputLabel>\n            <Select\n            name=\"spot\"\n            value={inputs.spot}\n              onChange={handleChange}\n              sx={{ mb: 2 }}\n          >\n            <MenuItem value=\"車両交通量\">車両交通量</MenuItem>\n            <MenuItem value=\"道幅\">道幅</MenuItem>\n            <MenuItem value=\"歩道\">歩道</MenuItem>\n            <MenuItem value=\"横断歩道\">横断歩道</MenuItem>\n              <MenuItem value=\"立哨・見守り\">立哨・見守り</MenuItem>\n            <MenuItem value=\"カーブミラー\">カーブミラー</MenuItem>\n            <MenuItem value=\"信号機\">信号機</MenuItem>\n            <MenuItem value=\"見通し\">見通し</MenuItem>\n            </Select>\n          </FormControl>\n\n          <TextField\n            label=\"内容\"\n            name=\"introduction\"\n            multiline\n            rows={4}\n            value={inputs.introduction}\n            onChange={handleChange}\n            sx={{ mb: 2 }}\n          />\n        </FormControl>\n\n        <Button variant=\"contained\" onClick={handleSubmit} disabled={isLoading} fullWidth sx={{ margin: '24px 0' }}>\n          投稿\n        </Button>\n\n        {isLoading && <CircularIndeterminate />}\n      </div>\n    </>\n  )\n}\n\nexport default Content\n","import './Post.scss'\nimport Form from './Form'\n\nconst Content = () => {\n\n\n  return (\n    <>\n      <Form />\n    </>\n  )\n}\n\nexport default Content\n","import { useState, useEffect } from \"react\"\nimport { Routes, Route } from \"react-router-dom\";\nimport \"./App.scss\";\n\nimport Home from './App/Home'\nimport List from './App/List'\nimport Tabbar from './App/Tabbar'\nimport Post from './App/Post'\nimport { getSafetyData } from \"./api\"\n\nconst sortShopList = async (shopList: Pwamap.ShopData[]) => {\n\n  // 新着順にソート\n  return shopList.sort(function (item1, item2) {\n    return Date.parse(item2['タイムスタンプ']) - Date.parse(item1['タイムスタンプ'])\n  });\n\n}\n\nconst App = () => {\n  const [shopList, setShopList] = useState<Pwamap.ShopData[]>([])\n  const [isLoading, setIsLoading] = useState<boolean>(true)\n\n  useEffect(() => {\n    fetch(`${process.env.PUBLIC_URL}/data.json?timestamp=${new Date().getTime()}`)\n      .then((response) => {\n        return response.ok ? response.text() : Promise.reject(response.status);\n      })\n      .then((fetchedData) => {\n\n        const data = JSON.parse(fetchedData)\n\n        if ('values' in data === false) {\n          console.log(\"No Data Found at Spreadsheet\")\n          setShopList([])\n          return\n        }\n\n        (async () => {\n          const res = await getSafetyData()\n          const features = JSON.parse(res)\n\n          setIsLoading(false)\n\n          if (features.length) {\n            const nextShopList: Pwamap.ShopData[] = []\n            for (let i = 0;i < features.length;i++) {\n              const feature = features[i] as Pwamap.ShopData\n              if (!feature['緯度'] || !feature['経度'] || !feature['スポット名']) {\n                continue\n              }\n\n              const pattern = /^-?[0-9]+(\\.[0-9]+)?$/\n\n              if (!pattern.test(feature['緯度'])) {\n                console.log('緯度が不正です')\n                continue\n              }\n              if (!pattern.test(feature['経度'])) {\n                console.log('経度が不正です')\n                continue\n              }\n\n              const shop = {\n                ...feature,\n                index: i\n              }\n\n              nextShopList.push(shop)\n\n              sortShopList(nextShopList).then((sortedShopList) => {\n                setShopList(sortedShopList)\n              })\n            }\n          }\n        })()\n      });\n  }, [])\n\n  return (\n    <>\n      {!isLoading ? <div className=\"app\">\n        <div className=\"app-body\">\n          <Routes>\n            <Route path=\"/\" element={<Home data={shopList} />} />\n            <Route path=\"/post\" element={<Post />} />\n            <Route path=\"/list\" element={<List data={shopList} />} />\n          </Routes>\n        </div>\n        <div className=\"app-footer\">\n          <Tabbar />\n        </div>\n      </div> : ''}\n    </>\n  );\n}\n\nexport default App;\n","import { useQRCode } from 'next-qrcode';\n\nfunction Qrcode(props: { url: string }) {\n\n  const { url } = props;\n  const { Canvas } = useQRCode();\n\n  return (\n    <Canvas\n      text={url}\n      options={{\n        type: 'image/png',\n        margin: 0,\n        width: 128\n      }}\n    />\n  );\n}\n\nexport default Qrcode;\n","import './About.scss'\nimport Qrcode from './Qrcode'\nimport config from './config.json'\n\nconst Content = () => {\n\n  const logoUrl = config.logo_image_url || `${process.env.PUBLIC_URL}/logo.svg`\n\n  return (\n    <div className=\"about\">\n      <div className=\"branding\">\n        <img className=\"image\" src={logoUrl} alt=\"\"/>\n      </div>\n\n      <div className=\"title\">{config.title}</div>\n      <div className=\"description\">スマホで確認ができます 👇</div>\n      <div className=\"qrcode\"><Qrcode url={window.location.href} /></div>\n    </div>\n  );\n};\n\nexport default Content;\n","import App from './App'\nimport About from './About'\nimport './Container.scss'\n\nfunction Content() {\n  return (\n    <div className=\"outer-container\">\n      <div className=\"inner-container\">\n        <About />\n        <App />\n      </div>\n    </div>\n  );\n}\n\nexport default Content;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter } from \"react-router-dom\";\nimport Container from './Container';\nimport './index.scss'\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <Container />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\nserviceWorkerRegistration.register();\n"],"sourceRoot":""}