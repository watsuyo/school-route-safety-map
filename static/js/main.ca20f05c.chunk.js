(this["webpackJsonpgeolonia-pwa"]=this["webpackJsonpgeolonia-pwa"]||[]).push([[0],{131:function(e){e.exports=JSON.parse('{"title":"\u901a\u5b66\u8def\u5b89\u5168\u30de\u30c3\u30d7 ","description":"\u901a\u5b66\u8def\u5b89\u5168\u30de\u30c3\u30d7\u306e\u8aac\u660e","form_url":"","logo_image_url":"https://raw.githubusercontent.com/watsuyo/school-route-safety-map/master/public/logo.jpg","background_image_url":"","primary_color":"#f5b041","orderby":"distance"}')},211:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){},242:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},262:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(32),s=n.n(c),o=n(41),i=n(54),u=n(4),l=n(37),d=n(29),p=n.n(d),j=n(26),b=(n(211),n(158)),f=n.n(b),h=function(e){var t={type:"FeatureCollection",features:[]};for(var n in e){var a=e[n];if(!a["\u7d4c\u5ea6"]||!a["\u7def\u5ea6"]||!a["\u30b9\u30dd\u30c3\u30c8\u540d"])return;for(var r={type:"Feature",geometry:{type:"Point",coordinates:[Number(a["\u7d4c\u5ea6"]),Number(a["\u7def\u5ea6"])]},properties:{_id:n}},c=0;c<Object.keys(a).length;c++){var s=Object.keys(a)[c];r.properties[s]=a[s]}t.features.push(r)}return t},x=function(e){e.addLayer({id:"clusters",type:"circle",source:"shops",filter:["has","point_count"],paint:{"circle-radius":20,"circle-color":"#FF0000","circle-opacity":1}}),e.addLayer({id:"cluster-count",type:"symbol",source:"shops",filter:["has","point_count"],paint:{"text-color":"#FFFFFF"},layout:{"text-field":"{point_count_abbreviated} \u4ef6","text-size":12,"text-font":["Noto Sans Regular"]}}),e.on("click","clusters",(function(t){var n=e.queryRenderedFeatures(t.point,{layers:["clusters"]}),a=n[0].properties.cluster_id;e.getSource("shops").getClusterExpansionZoom(a,(function(t,a){t||e.easeTo({center:n[0].geometry.coordinates,zoom:a})}))})),e.on("mouseenter","clusters",(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave","clusters",(function(){e.getCanvas().style.cursor=""}))},O=(n(218),function(e){var t="";return"number"!==typeof e||Number.isNaN(e)||(t=e>1e3?Math.round(e/1e3)+" km":Math.round(e)+" m"),t}),m=(n(219),n(3)),v=function(){return Object(m.jsx)("div",{className:"head",children:Object(m.jsx)("p",{children:"\u901a\u5b66\u8def\u5b89\u5168\u30de\u30c3\u30d7"})})},g=n(67),w=n.n(g),y="https://script.googleapis.com/v1/scripts/".concat("AKfycbwnv-EH1C95J6wSjfRpV28c3D-WE80NR2KVD-edX7zJauR0AYVZN95wXZfNxOsopZWq",":run"),k=function(){var e=Object(l.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return t=e.sent,e.abrupt("return",{Authorization:"Bearer ".concat(t)});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={client_id:"430416577043-vaudgfur0pdk5qqc1bmrfchuuf5cgkcv.apps.googleusercontent.com",client_secret:"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",refresh_token:"1//0ejQEdwBJDx_uCgYIARAAGA4SNwF-L9Irw8w44X-7S4kYaW84_Ra2ae7t8f0KdwmOsVUB9QjOCpJZWxaPaIp7bsfkio69JR0ebFA",grant_type:"refresh_token"},e.next=3,w.a.post("https://oauth2.googleapis.com/token",t);case 3:if(200===(n=e.sent).status&&n.data){e.next=6;break}throw new Error("Failed to get access token.");case 6:return a=n.data.access_token,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(p.a.mark((function e(t,n){var a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={function:"postUserPost",parameters:t},e.next=4,k();case 4:return r=e.sent,e.next=7,w.a.create({headers:r});case 7:return c=e.sent,e.next=10,c.post(y,a);case 10:if(!e.sent.data.response["@type"].includes("error")){e.next=15;break}throw new Error;case 15:n("/?success");case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.error(e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(l.a)(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={function:"getSafetyData"},e.next=4,k();case 4:return n=e.sent,e.next=7,w.a.create({headers:n});case 7:return a=e.sent,e.next=10,a.post(y,t);case 10:if(!(r=e.sent).data.response["@type"].includes("error")){e.next=15;break}throw new Error;case 15:return e.abrupt("return",r.data.response.result);case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.error(e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(p.a.mark((function e(t){var n,a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={function:"postLike",parameters:t},e.next=4,k();case 4:return a=e.sent,e.next=7,w.a.create({headers:a});case 7:return r=e.sent,e.next=10,r.post(y,n);case 10:if(!(c=e.sent).data.response["@type"].includes("error")){e.next=15;break}throw new Error;case 15:return e.abrupt("return",c.data.response.result);case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.error(e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(p.a.mark((function e(t){var n,a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={function:"postUnlike",parameters:t},e.next=4,k();case 4:return a=e.sent,e.next=7,w.a.create({headers:a});case 7:return r=e.sent,e.next=10,r.post(y,n);case 10:if(!(c=e.sent).data.response["@type"].includes("error")){e.next=15;break}throw new Error;case 15:return e.abrupt("return",c.data.response.result);case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.error(e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),_=n(402),M=function(e){var t=Object(a.useRef)(null),n=Object(a.useState)(null),r=Object(u.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)(0),d=Object(u.a)(i,2),j=d[0],b=d[1],f=Object(a.useState)(!1),h=Object(u.a)(f,2),x=h[0],g=h[1],w=Object(a.useState)(!1),y=Object(u.a)(w,2),k=y[0],N=y[1],S=e.shop,F=function(){e.close(),t.current&&(t.current.remove(),c.remove())};Object(a.useEffect)((function(){if(t.current){var e=new window.geolonia.Map({container:t.current,interactive:!1,zoom:14,style:"geolonia/gsi"});s(e),g(!!localStorage.getItem("like:".concat(S.index)))}}),[S,t]);var M,P=O(S.distance),L=S["\u30ab\u30c6\u30b4\u30ea"],A=S["\u7d39\u4ecb\u6587"],W=function(){var e=Object(l.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.next=3,C({index:S.index});case 3:t=e.sent,b(t),localStorage.setItem("like:".concat(S.index),"true"),g(!0),N(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(l.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.next=3,E({index:S.index});case 3:t=e.sent,b(t),localStorage.removeItem("like:".concat(S.index)),g(!1),N(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"shop-single",children:[Object(m.jsx)(v,{}),Object(m.jsxs)("div",{className:"shop-container",children:[Object(m.jsx)("div",{className:"back",children:Object(m.jsx)("button",{onClick:F,children:"< \u623b\u308b"})}),S?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{children:S["\u30b9\u30dd\u30c3\u30c8\u540d"]}),Object(m.jsxs)("div",{style:{margin:"0 0 12px 0"},children:[Object(m.jsx)("span",{className:"nowrap",children:Object(m.jsx)(o.b,{to:"/list?category=".concat(L),children:Object(m.jsx)("span",{onClick:F,className:"category",children:L})})}),Object(m.jsx)("span",{className:"nowrap",children:P&&Object(m.jsxs)("span",{className:"distance",children:["\u73fe\u5728\u4f4d\u7f6e\u304b\u3089 ",P]})})]}),0===S["\u3044\u3044\u306d\u6570"]||S["\u3044\u3044\u306d\u6570"]>0?Object(m.jsxs)("div",{style:{display:"flex"},children:[k?Object(m.jsx)(_.a,{}):Object(m.jsx)("img",{src:x?"thumb-up.png":"thumb-up-outline.png",alt:"\u3044\u3044\u306d",width:"28px",className:"like-button",onClick:x?R:W}),Object(m.jsx)("p",{style:{margin:"2px"},children:j||S["\u3044\u3044\u306d\u6570"]})]}):Object(m.jsx)(m.Fragment,{}),Object(m.jsx)("p",{style:{margin:"24px 0",wordBreak:"break-all"},children:(M=A,M.split(/(\r\n)|(\n)|(\r)/g).map((function(e,t){var n="";return"\r\n"===e||"\n"===e||"\r"===e?n=Object(m.jsx)("br",{},t):void 0!==e&&(n=e),n})))}),Object(m.jsx)("div",{ref:t,style:{width:"100%",height:"200px",marginTop:"24px"},"data-lat":S["\u7def\u5ea6"],"data-lng":S["\u7d4c\u5ea6"],"data-navigation-control":"off"})]}):Object(m.jsx)(m.Fragment,{})]})]})},P=n(403),L=n(43),A=n(404),W=n(93),R=n(162);function Y(e){var t=function(t){"Enter"!==t.key?e.setPlace(t.target.value):e.geocode()};return Object(m.jsxs)(P.a,{component:"form",sx:{p:"2px 4px",display:"flex",alignItems:"center"},children:[Object(m.jsx)(A.a,{type:"button",sx:{p:"10px"},"aria-label":"search",children:Object(m.jsx)(W.c,{})}),Object(m.jsx)(L.c,{sx:{ml:1,flex:1},placeholder:"\u4f4f\u6240\u3067\u691c\u7d22",inputProps:{"aria-label":"\u4f4f\u6240\u3067\u691c\u7d22"},onChange:function(e){return t(e)},onKeyPress:function(e){return t(e)},style:{height:"60px"}}),Object(m.jsx)(R.a,{googleMapsApiKey:"AIzaSyCSy4kD_a3hae88KcIsYhVaXqY4Yn3P-sI"})]})}var D={width:"100%",height:"100%",position:"relative"},I=function(e){for(var t=["poi","poi-primary","poi-r0-r9","poi-r10-r24","poi-r25","poi-bus","poi-entrance"],n=0;n<t.length;n++){var a=t[n];e.setLayoutProperty(a,"visibility","none")}},z=function(e){var t=(e||window.location).hash.substring(2);return new URLSearchParams(t)},B=function(e){var t=r.a.useRef(null),n=r.a.useState(),c=Object(u.a)(n,2),s=c[0],o=c[1],i=r.a.useState(void 0),l=Object(u.a)(i,2),d=l[0],p=l[1],j=Object(u.a)(e.useZLatLngString,2),b=j[0],O=j[1];r.a.useEffect((function(){!function(e,t){e&&t&&e.on("render",(function(){if(!e.getSource("shops")){I(e);var n=h(t);e.addSource("shops",{type:"geojson",data:n,cluster:!0,clusterMaxZoom:14,clusterRadius:25}),e.addLayer({id:"shop-points",type:"circle",source:"shops",filter:["all",["==","$type","Point"]],paint:{"circle-radius":13,"circle-color":"#FF0000","circle-opacity":.4,"circle-stroke-width":2,"circle-stroke-color":"#FFFFFF","circle-stroke-opacity":1}}),e.addLayer({id:"shop-symbol",type:"symbol",source:"shops",filter:["all",["==","$type","Point"]],paint:{"text-color":"#000000","text-halo-color":"#FFFFFF","text-halo-width":2},layout:{"text-field":"{\u30b9\u30dd\u30c3\u30c8\u540d}","text-font":["Noto Sans Regular"],"text-variable-anchor":["top","bottom","left","right"],"text-radial-offset":.5,"text-justify":"auto","text-size":12,"text-anchor":"top","text-max-width":12,"text-allow-overlap":!1}}),e.on("mouseenter","shop-points",(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave","shop-points",(function(){e.getCanvas().style.cursor=""})),e.on("mouseenter","shop-symbol",(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave","shop-symbol",(function(){e.getCanvas().style.cursor=""})),e.on("click","shop-points",(function(e){e.features[0].properties.cluster||p(e.features[0].properties)})),e.on("click","shop-symbol",(function(e){e.features[0].properties.cluster||p(e.features[0].properties)})),x(e)}}))}(s,e.data)}),[s,e.data]),r.a.useEffect((function(){var e,t=z();b&&t.set("map",b),(e=t).toString()&&(window.location.hash="#/?".concat(e.toString().replace(/%2F/g,"/")))}),[b]);var g=(z().get("map")||"").split("/"),w=Object(a.useState)(g[1]),y=Object(u.a)(w,2),k=y[0],N=y[1],S=Object(a.useState)(g[2]),F=Object(u.a)(S,2),C=F[0],E=F[1],_=Object(a.useState)(),P=Object(u.a)(_,2),L=P[0],A=P[1],W=window.geolonia,R=h(e.data),B=f()(R);r.a.useEffect((function(){if(t.current&&!s){var e=new W.Map({container:t.current,style:"geolonia/gsi",bounds:B,fitBoundsOptions:{padding:50}}),n=z();if(n&&n.get("map")){var a=(n.get("map")||"").split("/"),r=a[0],c=a[1],i=a[2];e.flyTo({center:[i,c],zoom:r})}else B&&e.fitBounds(B,{padding:50});var u=function(){I(e),o(e),e.on("moveend",(function(){var t=e.getCenter(),n=e.getZoom(),a=Math.round(100*n)/100,r=Math.ceil((a*Math.LN2+Math.log(512/360/.5))/Math.LN10),c=Math.pow(10,r),s=Math.round(t.lng*c)/c,o=Math.round(t.lat*c)/c,i=Math.ceil(a);O("".concat(i,"/").concat(o,"/").concat(s))}))},l=function(){e.resize()};return e.on("load",u),window.addEventListener("orientationchange",l),function(){window.removeEventListener("orientationchange",l),e.off("load",u)}}}));return Object(m.jsxs)("div",{style:D,children:[Object(m.jsx)(v,{}),Object(m.jsx)(Y,{geocode:function(){(new window.google.maps.Geocoder).geocode({address:L},(function(e,n){if("OK"===n&&e){var a=e[0].geometry.location.lat().toString(),r=e[0].geometry.location.lng().toString();N(a),E(r),new W.Map({container:t.current,style:"geolonia/gsi",bounds:B,fitBoundsOptions:{padding:50}}).flyTo({center:[r,a],zoom:16})}}))},setPlace:A}),Object(m.jsx)("div",{ref:t,style:D,"data-lat":k,"data-lng":C,"data-geolocate-control":"on","data-marker":"off"}),d?Object(m.jsx)(M,{shop:d,close:function(){p(void 0)}}):Object(m.jsx)(m.Fragment,{})]})},T=(n(242),n(392)),J=Object(a.lazy)((function(){return(e=1e3,new Promise((function(t){return setTimeout(t,e)}))).then((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,412))}));var e})),K=function(e){var t=Object(j.e)(),n=r.a.useState(""),c=r.a.useState(!1),s=Object(u.a)(c,1)[0];return Object(m.jsxs)("div",{className:"home-container",children:[Object(m.jsx)(o.b,{to:"/post?".concat(n[0]),children:s?Object(m.jsx)(T.a,{className:"center",title:"\u3053\u306e\u4f4d\u7f6e\u306b\u8981\u671b\u3092\u6295\u7a3f",placement:"top",arrow:!0,open:!0,children:Object(m.jsx)("div",{children:Object(m.jsx)("img",{src:"map-pin.png",alt:"map pin",className:"map-pin"})})}):""}),Object(m.jsx)(B,{data:e.data,useZLatLngString:n}),Object(m.jsx)(a.Suspense,{fallback:"",children:t.search.includes("success")?Object(m.jsx)(J,{}):""})]})},Z=n(18),H=n(163),X=(n(243),function(e){var t=function(){e.popupHandler(e.data)},n=O(e.data.distance),a=e.data["\u30ab\u30c6\u30b4\u30ea"];return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"shop-link",children:[Object(m.jsx)("h2",{className:"shop-title",style:{wordBreak:"break-all"},onClick:t,children:e.data["\u30b9\u30dd\u30c3\u30c8\u540d"]}),Object(m.jsxs)("div",{className:"tag-box",children:[Object(m.jsx)("span",{className:"nowrap",children:Object(m.jsx)(o.b,{to:"/list?category=".concat(a),children:Object(m.jsx)("span",{className:"category",children:a})})}),Object(m.jsx)("span",{className:"nowrap",children:n&&Object(m.jsxs)("span",{className:"distance",children:["\u73fe\u5728\u4f4d\u7f6e\u304b\u3089 ",n]})})]}),Object(m.jsx)("div",{style:{margin:"10px 10px 10px 0"}}),Object(m.jsx)("div",{className:"right",onClick:t,children:Object(m.jsx)(H.a,{size:"40px",color:"#CCCCCC"})})]})})}),U=(n(244),n(164)),q=n(118),V=n(171),$=function(){var e=Object(l.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition||e(null),window.navigator.geolocation.getCurrentPosition((function(t){var n=t.coords.latitude,a=t.coords.longitude;e([a,n])}),(function(t){e(null)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}));case 2:if(!(n=e.sent)){e.next=10;break}return a=q.point(n),(r=t.map((function(e){var t=parseFloat(e["\u7d4c\u5ea6"]),n=parseFloat(e["\u7def\u5ea6"]);if(Number.isNaN(t)||Number.isNaN(n))return e;var r=q.point([t,n]),c=q.distance(a,r,{units:"meters"});return Object(i.a)(Object(i.a)({},e),{},{distance:c})}))).sort((function(e,t){return"number"!==typeof e.distance||Number.isNaN(e.distance)?1:"number"!==typeof t.distance||Number.isNaN(t.distance)?-1:e.distance-t.distance})),e.abrupt("return",r);case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e){var t=Object(j.f)(),n=r.a.useState(),a=Object(u.a)(n,2),c=a[0],s=a[1],i=r.a.useState(e.data),l=Object(u.a)(i,2),d=l[0],p=l[1],b=r.a.useState([]),f=Object(u.a)(b,2),h=f[0],x=f[1],O=r.a.useState(10),g=Object(u.a)(O,2),w=g[0],y=g[1],k=r.a.useState(!0),N=Object(u.a)(k,2),S=N[0],F=N[1],C=r.a.useState([]),E=Object(u.a)(C,2),_=E[0],P=E[1],L=Object(o.c)(),A=Object(u.a)(L,1)[0].get("category");r.a.useEffect((function(){for(var t=[],n=0;n<e.data.length;n++){var a=e.data[n];-1===t.indexOf(a["\u30ab\u30c6\u30b4\u30ea"])&&t.push(a["\u30ab\u30c6\u30b4\u30ea"])}P(t);var r=e.data;A&&(r=e.data.filter((function(e){return e["\u30ab\u30c6\u30b4\u30ea"]===A})));var c=!0;if(c){$(r).then((function(e){c&&(x(e.slice(0,w)),p(e))}))}return function(){c=!1}}),[e.data,A,w]);var W=function(e){e&&s(e)},R=Object(m.jsx)("div",{className:"loader",style:{width:"100%",height:"200px",textAlign:"center",position:"relative",top:"100px"},children:"\u5834\u6240\u4e00\u89a7\u3092\u8aad\u307f\u8fbc\u307f\u4e2d\u3067\u3059..."},0);return Object(m.jsxs)("div",{id:"shop-list",className:"shop-list",children:[Object(m.jsx)(v,{}),Object(m.jsx)("div",{className:"category-item",children:Object(m.jsxs)("div",{className:"category-container",children:[Object(m.jsx)("label",{htmlFor:"category-select",children:"\u30ab\u30c6\u30b4\u30ea\u304b\u3089\u9078\u3076"}),Object(m.jsx)(V.a,{onChange:function(e){e&&t("/list?category=".concat(e.value))},options:_.map((function(e){return{value:e,label:e}}))})]})}),Object(m.jsx)(U.a,{dataLength:h.length,next:function(){h.length>=d.length?F(!1):(x([].concat(Object(Z.a)(h),Object(Z.a)(d.slice(w,w+10)))),y(w+10))},hasMore:S,loader:R,scrollableTarget:"shop-list",children:h.map((function(e,t){return Object(m.jsx)("div",{className:"shop",children:Object(m.jsx)(X,{data:e,popupHandler:W})},t)}))}),c?Object(m.jsx)(M,{shop:c,close:function(){s(void 0)}}):Object(m.jsx)(m.Fragment,{})]})},Q=(n(257),function(){return Object(m.jsx)("div",{className:"tabbar",children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsxs)(o.b,{to:"/",children:[Object(m.jsx)("div",{className:"icon",children:Object(m.jsx)(W.a,{})}),Object(m.jsx)("div",{className:"text",children:"\u30db\u30fc\u30e0"})]})}),Object(m.jsx)("li",{children:Object(m.jsxs)(o.b,{to:"/list",children:[Object(m.jsx)("div",{className:"icon",children:Object(m.jsx)(W.b,{})}),Object(m.jsx)("div",{className:"text",children:"\u4e00\u89a7"})]})})]})})}),ee=(n(258),n(5)),te=n(400),ne=n(397),ae=n(398),re=n(389),ce=n(393),se=n(401),oe=n(172),ie=n(174),ue=n(390),le=n(379),de=n(387),pe=n(69),je=n.n(pe),be=n(405);function fe(){return Object(m.jsx)(be.a,{sx:{display:"flex",justifyContent:"center"},children:Object(m.jsx)(_.a,{})})}n(259);var he=window.location.hash.split("/"),xe=he[2],Oe=he[3],me=function(){var e=Object(a.useState)({title:"",category:"\u4f4f\u6c11\u8981\u671b",latitude:xe,longitude:Oe,timestamp:je()().format("YYYY-MM-DDTHH:mm:ss"),spot:"",introduction:""}),t=Object(u.a)(e,2),n=t[0],r=t[1],c=function(e){var t,n,a=null===(t=e.target)||void 0===t?void 0:t.name,c=a?null===(n=e.target)||void 0===n?void 0:n.value:je()(e).format("YYYY-MM-DDTHH:mm:ss");r((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(ee.a)({},a||"timestamp",c))}))},s=Object(a.useState)(!1),o=Object(u.a)(s,2),d=o[0],b=o[1],f=Object(j.f)(),h=function(){var e=Object(l.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,S(n,f);case 3:b(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=Object(a.useState)(""),O=Object(u.a)(x,2),g=O[0],y=O[1];return Object(a.useEffect)((function(){Object(l.a)(p.a.mark((function e(){var t,n,a,r,c,s,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.location.hash.split("/"),n=t[2],a=t[3],!n||!a){e.next=11;break}return e.next=6,w.a.get("https://aginfo.cgk.affrc.go.jp/ws/rgeocode.php?json",{params:{lat:n,lon:a}});case 6:r=e.sent,c=r.data.result,s=c.prefecture.pname,o=c.municipality.mname,i=c.local[0].section,y(s+o+i);case 11:case"end":return e.stop()}}),e)})))()})),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v,{}),Object(m.jsxs)("div",{className:"form-container",children:[Object(m.jsx)(te.a,{variant:"h5",gutterBottom:!0,margin:"normal",children:"\u8981\u671b\u3092\u6295\u7a3f"}),Object(m.jsx)(te.a,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:g?g+" \u4ed8\u8fd1":""}),Object(m.jsxs)(ne.a,{fullWidth:!0,children:[Object(m.jsx)(oe.a,{dateAdapter:ie.a,children:Object(m.jsx)(le.a,{spacing:3,sx:{mb:2},children:Object(m.jsx)(de.a,{renderInput:function(e){return Object(m.jsx)(ue.a,Object(i.a)({},e))},label:"\u65e5\u6642",value:n.timestamp,onChange:c})})}),Object(m.jsxs)(ne.a,{fullWidth:!0,children:[Object(m.jsx)(ae.a,{children:"\u30b9\u30dd\u30c3\u30c8"}),Object(m.jsxs)(re.a,{name:"spot",value:n.spot,onChange:c,sx:{mb:2},children:[Object(m.jsx)(ce.a,{value:"\u8eca\u4e21\u4ea4\u901a\u91cf",children:"\u8eca\u4e21\u4ea4\u901a\u91cf"}),Object(m.jsx)(ce.a,{value:"\u9053\u5e45",children:"\u9053\u5e45"}),Object(m.jsx)(ce.a,{value:"\u6b69\u9053",children:"\u6b69\u9053"}),Object(m.jsx)(ce.a,{value:"\u6a2a\u65ad\u6b69\u9053",children:"\u6a2a\u65ad\u6b69\u9053"}),Object(m.jsx)(ce.a,{value:"\u7acb\u54e8\u30fb\u898b\u5b88\u308a",children:"\u7acb\u54e8\u30fb\u898b\u5b88\u308a"}),Object(m.jsx)(ce.a,{value:"\u30ab\u30fc\u30d6\u30df\u30e9\u30fc",children:"\u30ab\u30fc\u30d6\u30df\u30e9\u30fc"}),Object(m.jsx)(ce.a,{value:"\u4fe1\u53f7\u6a5f",children:"\u4fe1\u53f7\u6a5f"}),Object(m.jsx)(ce.a,{value:"\u898b\u901a\u3057",children:"\u898b\u901a\u3057"})]})]}),Object(m.jsx)(ue.a,{label:"\u5185\u5bb9",name:"introduction",multiline:!0,rows:4,value:n.introduction,onChange:c,sx:{mb:2}})]}),Object(m.jsx)(se.a,{variant:"contained",onClick:h,disabled:d,fullWidth:!0,sx:{margin:"24px 0"},children:"\u6295\u7a3f"}),d&&Object(m.jsx)(fe,{})]})]})},ve=function(){return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(me,{})})},ge=function(){var e=Object(l.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sort((function(e,t){return Date.parse(t["\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7"])-Date.parse(e["\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7"])})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!0),s=Object(u.a)(c,2),o=s[0],d=s[1];return Object(a.useEffect)((function(){fetch("".concat(".","/data.json?timestamp=").concat((new Date).getTime())).then((function(e){return e.ok?e.text():Promise.reject(e.status)})).then((function(e){if("values"in JSON.parse(e)===!1)return console.log("No Data Found at Spreadsheet"),void r([]);Object(l.a)(p.a.mark((function e(){var t,n,a,c,s,o,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:if(t=e.sent,n=JSON.parse(t),d(!1),!n.length){e.next=25;break}a=[],c=0;case 8:if(!(c<n.length)){e.next=25;break}if((s=n[c])["\u7def\u5ea6"]&&s["\u7d4c\u5ea6"]&&s["\u30b9\u30dd\u30c3\u30c8\u540d"]){e.next=12;break}return e.abrupt("continue",22);case 12:if((o=/^-?[0-9]+(\.[0-9]+)?$/).test(s["\u7def\u5ea6"])){e.next=16;break}return console.log("\u7def\u5ea6\u304c\u4e0d\u6b63\u3067\u3059"),e.abrupt("continue",22);case 16:if(o.test(s["\u7d4c\u5ea6"])){e.next=19;break}return console.log("\u7d4c\u5ea6\u304c\u4e0d\u6b63\u3067\u3059"),e.abrupt("continue",22);case 19:u=Object(i.a)(Object(i.a)({},s),{},{index:c}),a.push(u),ge(a).then((function(e){r(e)}));case 22:c++,e.next=8;break;case 25:case"end":return e.stop()}}),e)})))()}))}),[]),Object(m.jsx)(m.Fragment,{children:o?"":Object(m.jsxs)("div",{className:"app",children:[Object(m.jsx)("div",{className:"app-body",children:Object(m.jsxs)(j.c,{children:[Object(m.jsx)(j.a,{path:"/",element:Object(m.jsx)(K,{data:n})}),Object(m.jsx)(j.a,{path:"/post",element:Object(m.jsx)(ve,{})}),Object(m.jsx)(j.a,{path:"/list",element:Object(m.jsx)(G,{data:n})})]})}),Object(m.jsx)("div",{className:"app-footer",children:Object(m.jsx)(Q,{})})]})})},ye=(n(262),n(169));var ke=function(e){var t=e.url,n=Object(ye.a)().Canvas;return Object(m.jsx)(n,{text:t,options:{type:"image/png",margin:0,width:128}})},Ne=n(131),Se=function(){var e=Ne.logo_image_url||"".concat(".","/logo.svg");return Object(m.jsxs)("div",{className:"about",children:[Object(m.jsx)("div",{className:"branding",children:Object(m.jsx)("img",{className:"image",src:e,alt:""})}),Object(m.jsx)("div",{className:"title",children:Ne.title}),Object(m.jsx)("div",{className:"description",children:"\u30b9\u30de\u30db\u3067\u78ba\u8a8d\u304c\u3067\u304d\u307e\u3059 \ud83d\udc47"}),Object(m.jsx)("div",{className:"qrcode",children:Object(m.jsx)(ke,{url:window.location.href})})]})};n(285);var Fe=function(){return Object(m.jsx)("div",{className:"outer-container",children:Object(m.jsxs)("div",{className:"inner-container",children:[Object(m.jsx)(Se,{}),Object(m.jsx)(we,{})]})})},Ce=(n(286),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Ee(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(o.a,{children:Object(m.jsx)(Fe,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");Ce?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ee(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ee(t,e)}))}}()}},[[287,1,2]]]);
//# sourceMappingURL=main.ca20f05c.chunk.js.map